module examples.compiler.domains
export Date, Calendar, addWeek, addTwoWeeks, shiftBy

Date = { year: Int, month: Int, day: Int }

domain Calendar over Date = {
  type Delta = Day Int
    | Week Int

  plus = d => delta => delta ?
    | Day n  => addDays d n
    | Week n => addDays d (n * 7)

  d1 = Day 1
  w1 = Week 1

  addDays = d => n => d <| { day: (_ + n) }

  addWeek = d => plus d w1

  addTwoWeeks = d => plus (plus d w1) w1

  shiftBy = d => delta => plus d delta
}
